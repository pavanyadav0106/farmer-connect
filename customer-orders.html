<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Orders | Farmer Connect</title>

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/android-chrome-192x192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/assets/android-chrome-512x512.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png" />
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="manifest" href="/assets/site.webmanifest" />
  <link rel="stylesheet" href="css/customer-review.css">

  <!-- Styles -->
  <link rel="stylesheet" href="css/customer-orders.css" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
  <link rel="stylesheet" href="css/customer-darkmode.css">

</head>
<body>
  <!-- Top Navigation -->
<header class="top-nav">
  <div class="top-nav-left">
    <button id="backBtn" class="btn-back" title="Go Back">
      <i class="fas fa-arrow-left"></i>
    </button>
  </div>

  <!-- perfectly centered logo -->
  <div class="logo-wrapper">
    <a href="customer-dashboard.html" class="logo-text">ðŸŒ¾ FARMER CONNECT</a>
  </div>

  <div class="top-nav-right">
    <div class="user-chip">
      <div class="user-avatar">C</div>
      <div class="user-meta">
        <span class="user-name" id="customerName">Customer</span>
        <span class="user-role">Customer</span>
      </div>
    </div>
  </div>
</header>


  <main class="orders-page">
    <section class="orders-header">
      <div>
        <h1>My Orders</h1>
        <p class="subtitle">
          View and track all your orders placed with farmers in real time.
        </p>
      </div>
      <div class="orders-header-meta">
        <span class="last-updated">
          <i class="fas fa-clock"></i>
          Last updated: <span id="lastUpdated">just now</span>
        </span>
      </div>
    </section>

    <!-- Summary Cards -->
    <section class="orders-summary">
      <div class="summary-card">
        <div class="summary-label">Total Orders</div>
        <div class="summary-value" id="totalOrdersCount">0</div>
        <div class="summary-chip">
          <i class="fas fa-receipt"></i>
          <span>All time</span>
        </div>
      </div>

      <div class="summary-card">
        <div class="summary-label">Active</div>
        <div class="summary-value" id="activeOrdersCount">0</div>
        <div class="summary-chip status-processing">
          <i class="fas fa-spinner"></i>
          <span>Pending / Accepted</span>
        </div>
      </div>

      <div class="summary-card">
        <div class="summary-label">Completed</div>
        <div class="summary-value" id="completedOrdersCount">0</div>
        <div class="summary-chip status-completed">
          <i class="fas fa-check-circle"></i>
          <span>Delivered</span>
        </div>
      </div>

      <div class="summary-card">
        <div class="summary-label">Cancelled</div>
        <div class="summary-value" id="cancelledOrdersCount">0</div>
        <div class="summary-chip status-cancelled">
          <i class="fas fa-times-circle"></i>
          <span>Cancelled</span>
        </div>
      </div>
    </section>

    <section class="orders-container">
      <!-- Filters + Search + View Controls -->
      <div class="orders-toolbar">
        <div class="orders-toolbar-left">
          <div class="filter-group">
            <label for="statusFilter">Status</label>
            <select id="statusFilter">
              <option value="all">All Orders</option>
              <option value="processing">Pending</option>
              <option value="accepted">Accepted</option>
              <option value="completed">Completed</option>
              <option value="cancelled">Cancelled</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="dateFilter">Date</label>
            <select id="dateFilter">
              <option value="all">All Time</option>
              <option value="today">Today</option>
              <option value="week">This Week</option>
              <option value="month">This Month</option>
            </select>
          </div>

          <button id="resetFilters" class="btn-outline">
            <i class="fas fa-sync-alt"></i>
            Reset
          </button>
        </div>

        <div class="orders-toolbar-right">
          <div class="search-group">
            <label for="orderSearch" class="sr-only">Search Orders</label>
            <div class="search-input-wrapper">
              <i class="fas fa-search"></i>
              <input
                type="text"
                id="orderSearch"
                placeholder="Search by Order ID, farmer, or crop..."
                autocomplete="off"
              />
            </div>
          </div>

          <div class="filter-group">
            <label for="sortFilter">Sort</label>
            <select id="sortFilter">
              <option value="latest">Latest first</option>
              <option value="oldest">Oldest first</option>
              <option value="amountHigh">Amount: High to Low</option>
              <option value="amountLow">Amount: Low to High</option>
            </select>
          </div>

          <div class="view-toggle" aria-label="Toggle view mode">
            <button id="viewListBtn" class="icon-btn active" title="List view">
              <i class="fas fa-list"></i>
            </button>
            <button id="viewGridBtn" class="icon-btn" title="Card view">
              <i class="fas fa-border-all"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Orders Table / List -->
      <div class="orders-list-wrapper">
        <div class="orders-list-header">
          <div class="page-size-group">
            <label for="pageSizeSelect">Rows per page</label>
            <select id="pageSizeSelect">
              <option value="5">5</option>
              <option value="10" selected>10</option>
              <option value="20">20</option>
            </select>
          </div>

          <div class="legend">
            <span class="legend-item">
              <span class="status-pill status-processing"></span> Pending
            </span>
            <span class="legend-item">
              <span class="status-pill status-accepted"></span> Accepted
            </span>
            <span class="legend-item">
              <span class="status-pill status-completed"></span> Completed
            </span>
            <span class="legend-item">
              <span class="status-pill status-cancelled"></span> Cancelled
            </span>
          </div>
        </div>

        <div class="orders-list" data-view-mode="list">
          <table class="orders-table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Items</th>
                <th>Total</th>
                <th>Status</th>
                <th>Farmer</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="ordersTableBody">
              <!-- Orders will be inserted here by JavaScript -->
            </tbody>
          </table>

          <!-- Empty State -->
          <div id="emptyState" class="empty-state">
            <img
              src="https://cdn-icons-png.flaticon.com/512/4076/4076478.png"
              alt="No orders"
            />
            <h3>No orders found</h3>
            <p>Try adjusting your filters, search, or check back later.</p>
            <button id="refreshOrders" class="btn-primary">
              <i class="fas fa-sync-alt"></i> Refresh
            </button>
            <a href="customer-marketplace.html" class="btn-outline go-shop-btn">
              <i class="fas fa-shopping-basket"></i> Go to Marketplace
            </a>
          </div>

          <!-- Pagination -->
          <div class="pagination">
            <button id="firstPageBtn" disabled title="First page">
              <i class="fas fa-angle-double-left"></i>
            </button>
            <button id="prevPageBtn" disabled title="Previous page">
              <i class="fas fa-angle-left"></i>
            </button>

            <div id="pageNumbers" class="page-numbers">
              <!-- Page numbers rendered by JS -->
            </div>

            <button id="nextPageBtn" title="Next page">
              <i class="fas fa-angle-right"></i>
            </button>
            <button id="lastPageBtn" title="Last page">
              <i class="fas fa-angle-double-right"></i>
            </button>

            <div class="pagination-info">
              <span id="paginationInfo">0â€“0 of 0 orders</span>
            </div>
          </div>
        </div>

        <!-- Alternative Grid View Container (for future use) -->
        <div id="ordersGridContainer" class="orders-grid" aria-hidden="true">
          <!-- JS can render card-style orders here when grid view is active -->
        </div>
      </div>
    </section>
  </main>

  <!-- Order Details Modal -->
  <div id="orderModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <h2>Order Details</h2>
          <p class="modal-subtitle">
            <span id="modalOrderId">Order #â€”</span> Â·
            <span id="modalOrderStatus" class="status-badge">Status</span>
          </p>
        </div>
        <span class="close-btn" aria-label="Close">&times;</span>
      </div>

      <div id="modalBody" class="modal-body">
        <!-- Order details will be inserted here by JavaScript -->
        <!-- Suggested structure:
          - Order items list
          - Pricing breakdown
          - Farmer info
          - Delivery address
          - Payment method
        -->
      </div>

    <!-- In modal-footer section, add this button: -->
    <div class="modal-footer">
      <div class="modal-footer-left">
        <button id="downloadInvoiceBtn" class="btn-outline">
          <i class="fas fa-file-download"></i> Download Invoice
        </button>
        <button id="addReviewBtn" class="btn-outline">
          <i class="fas fa-star"></i> Add Review
        </button>
      </div>
      <div class="modal-footer-right">
        <button id="cancelOrderBtn" class="btn-danger">
          <i class="fas fa-times-circle"></i> Cancel Order
        </button>
        <button id="trackOrderBtn" class="btn-primary">
          <i class="fas fa-route"></i> Track Order
        </button>
      </div>
    </div>

  <!-- Optional: Loading Overlay -->
  <div id="ordersLoadingOverlay" class="loading-overlay" aria-hidden="true">
    <div class="loading-spinner"></div>
    <p>Loading your orders...</p>
  </div>

  <!-- Review Form Modal -->
<div id="reviewModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
  <div class="modal-content">
    <div class="modal-header">
      <div>
        <h2>Rate Your Purchase</h2>
        <p class="modal-subtitle">Share your experience with this crop</p>
      </div>
      <span class="close-btn close-review-modal" aria-label="Close">&times;</span>
    </div>
    
    <div class="modal-body">
      <form id="reviewForm" class="review-form">
        <div class="form-group">
          <label>Rating</label>
          <div class="rating-input">
            <span class="star-rating" data-value="5">â˜…</span>
            <span class="star-rating" data-value="4">â˜…</span>
            <span class="star-rating" data-value="3">â˜…</span>
            <span class="star-rating" data-value="2">â˜…</span>
            <span class="star-rating" data-value="1">â˜…</span>
          </div>
          <input type="hidden" id="reviewRating" name="rating" value="5" required>
        </div>
        
        <div class="form-group textarea-group">
          <label for="reviewComment">Your Review (Optional)</label>
          <textarea 
            id="reviewComment" 
            name="comment" 
            placeholder="Share details about your experience with this crop. Was it fresh? Good quality? Fair price?" 
            maxlength="500"
          ></textarea>
          <div class="char-count">
            <span id="charCount">0</span>/500 characters
          </div>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn-outline close-review-modal">
            Cancel
          </button>
          <button type="submit" class="btn-primary">
            <i class="fas fa-paper-plane"></i> Submit Review
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Existing Reviews Modal -->
<div id="existingReviewsModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
  <div class="modal-content">
    <div class="modal-header">
      <div>
        <h2 id="reviewsModalTitle">Customer Reviews</h2>
        <p class="modal-subtitle">What others are saying</p>
      </div>
      <span class="close-btn close-reviews-modal" aria-label="Close">&times;</span>
    </div>
    
    <div class="modal-body">
      <div id="reviewsContainer" class="reviews-container">
        <!-- Reviews will be loaded here -->
      </div>
    </div>
  </div>
</div>
  <script type="module" src="js/customer-orders.js"></script>
  <script src="js/customer-darkmode.js"></script>

</body>
</html>
